<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EV Predictions on Real - Sports</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #1e1e2f;
    color: #e0e0e0;
    padding: 20px;
}
h2 {
    color: #4a90e2;
    margin-bottom: 15px;
    text-align: center;
}
table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 15px;
    background-color: #2c2c3e;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 6px rgba(0,0,0,0.5);
}
th, td {
    border: 1px solid #444;
    padding: 10px;
    text-align: center;
}
th {
    background-color: #4a90e2;
    color: #ffffff;
    font-size: 14px;
}
input {
    width: 90px;
    padding: 5px;
    border-radius: 4px;
    border: 1px solid #666;
    background-color: #2c2c3e;
    color: #e0e0e0;
    text-align: center;
}
button {
    padding: 10px 16px;
    margin: 5px 5px 15px 0;
    border-radius: 6px;
    border: none;
    background-color: #4a90e2;
    color: #1e1e2f;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s;
}
button:hover {
    background-color: #357ABD;
}
.output {
    white-space: pre-line;
    font-family: monospace;
    background-color: #2c2c3e;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #444;
    margin-top: 15px;
    color: #e0e0e0;
}
.ev-positive { color: #00ff85; font-weight: bold; }
.ev-negative { color: #ff4d4d; font-weight: bold; }
.ev-zero { color: #aaa; }
.note {
    text-align: center;
    color: #bbb;
    margin-bottom: 15px;
    font-size: 14px;
}
/* Mobile responsiveness */
@media (max-width: 600px) {
    table, th, td, input, button {
        font-size: 12px;
        padding: 6px;
    }
    input {
        width: 70px;
    }
    button {
        padding: 8px 12px;
        margin-bottom: 10px;
    }
}
</style>
</head>
<body>
<h2>EV Predictions on Real - Sports</h2>
<p class="note">Enter FanDuel odds (trusted/true market). Use actual Real payout for accurate +EV detection. Green EV = good value to buy on Real!</p>

<table id="bets">
<tr>
  <th>Team / Prop</th>
  <th>FanDuel Odds</th>
  <th>RAX Bought</th>
  <th>Real Payout</th>
  <th>EV %</th>
  <th>Result (W/L)</th>
</tr>
<tr>
  <td><input placeholder="Team/Prop"></td>
  <td><input placeholder="e.g. -136"></td>
  <td><input placeholder="RAX"></td>
  <td><input placeholder="Total payout"></td>
  <td class="ev-zero">—</td>
  <td><input value="W"></td>
</tr>
</table>

<button onclick="addRow()">Add Bet</button>
<button onclick="generate()">Generate / Calc EV</button>
<button onclick="copyOutput()">Copy Recap</button>

<div class="output" id="output"></div>

<script>
function addRow() {
  const table = document.getElementById("bets");
  const row = table.insertRow();
  for (let i = 0; i < 6; i++) {
    const cell = row.insertCell();
    if (i === 4) { // EV column - no input
      cell.textContent = "—";
      cell.className = "ev-zero";
      continue;
    }
    const input = document.createElement("input");
    if (i === 5) input.value = "W";
    if (i === 0) input.placeholder = "Team/Prop";
    if (i === 1) input.placeholder = "e.g. -136";
    if (i === 2) input.placeholder = "RAX";
    if (i === 3) input.placeholder = "Total payout";
    cell.appendChild(input);
  }
}

// Convert American odds to implied probability %
function oddsToPercent(odds) {
  odds = Number(odds);
  if (isNaN(odds)) return 0;
  if (odds < 0) return Math.abs(odds) / (Math.abs(odds) + 100) * 100;
  if (odds > 0) return 100 / (odds + 100) * 100;
  return 50; // even money fallback
}

// Format EV with sign, %, and color
function formatEV(num) {
  if (isNaN(num)) return {text: "—", cls: "ev-zero"};
  const sign = num >= 0 ? '+' : '';
  const val = num.toFixed(1);
  let cls = "ev-zero";
  if (num > 0.5) cls = "ev-positive";
  if (num < -0.5) cls = "ev-negative";
  return {text: sign + val + '%', cls: cls};
}

// Calculate EV based on FanDuel (true) vs Real payout price
function calculateEV(fanduelOdds, rax, payout) {
  if (!rax || !payout || payout <= rax || isNaN(rax) || isNaN(payout)) {
    return {text: "—", cls: "ev-zero"};
  }
  const realMultiplier = payout / rax;                    // e.g. 12905 / 6000 = 2.1508
  const realImpliedProb = 100 / realMultiplier;           // implied % on Real
  const fanImpliedProb = oddsToPercent(fanduelOdds);      // trusted true %
  
  if (fanImpliedProb <= 0 || realImpliedProb <= 0) {
    return {text: "—", cls: "ev-zero"};
  }
  
  // EV % = (true_prob / real_implied_prob) - 1
  const ev = ((fanImpliedProb / realImpliedProb) - 1) * 100;
  return formatEV(ev);
}

function generate() {
  const table = document.getElementById("bets");
  let totalRisk = 0, totalProfit = 0, totalEV = 0, evCount = 0;
  let wins = 0, losses = 0;
  let betBlocks = "";
  let recapLines = "";

  for (let i = 1; i < table.rows.length; i++) {
    const cells = table.rows[i].cells;
    const team = cells[0].children[0]?.value.trim();
    const oddsStr = cells[1].children[0]?.value;
    const raxStr = cells[2].children[0]?.value;
    const payoutStr = cells[3].children[0]?.value;
    const result = (cells[5]?.children[0]?.value || "").toUpperCase();

    if (!team || isNaN(Number(oddsStr)) || isNaN(Number(raxStr))) continue;

    const odds = Number(oddsStr);
    const rax = Number(raxStr);
    const payout = payoutStr ? Number(payoutStr) : 0;

    const evObj = calculateEV(odds, rax, payout);
    cells[4].textContent = evObj.text;
    cells[4].className = evObj.cls;

    let profit = 0;
    if (result === "W") {
      profit = payout ? (payout - rax) : 0; // use actual payout if entered
      wins++;
    } else if (result === "L") {
      profit = -rax;
      losses++;
    }

    totalRisk += rax;
    totalProfit += profit;

    if (evObj.text !== "—" && evObj.text !== "") {
      const evVal = parseFloat(evObj.text);
      totalEV += evVal;
      evCount++;
    }

    const fanProb = oddsToPercent(odds).toFixed(1);
    const realProbEst = payout ? (100 / (payout / rax)).toFixed(1) : "—";

    betBlocks += 
`Team/Prop: ${team}
FanDuel Odds: ${odds} (~${fanProb}%)
RAX Bought: ${rax.toLocaleString()}
Real Payout: ${payout ? payout.toLocaleString() : "—"}
EV: ${evObj.text}  (FanDuel ${fanProb}% vs Real ~${realProbEst}%)
Result: ${result === "W" ? "✅ Win" : result === "L" ? "❌ Loss" : "Pending"}
-------------------
`;

    recapLines += `${team} (${odds}): ${result === "W" ? "✅" : result === "L" ? "❌" : "?"}   EV ${evObj.text}\n`;
  }

  const avgEV = evCount > 0 ? totalEV / evCount : 0;
  const actualReturn = totalRisk > 0 ? (totalProfit / totalRisk) * 100 : 0;
  const luck = actualReturn - avgEV;

  document.getElementById("output").textContent =
betBlocks +
"-----------------\n" +
recapLines +
"-----------------\n" +
`Record: ${wins}-${losses}   (Pending: ${table.rows.length - 1 - wins - losses})\n` +
`Total Risk: ${totalRisk.toLocaleString()} RAX\n` +
`Profit: ${totalProfit.toFixed(0)} RAX\n` +
`Average EV: ${formatEV(avgEV).text}\n` +
`Actual Return: ${(actualReturn >= 0 ? '+' : '') + actualReturn.toFixed(1)}%\n` +
`Luck (Actual - EV): ${(luck >= 0 ? '+' : '') + luck.toFixed(1)}%`;
}

// Copy to clipboard
function copyOutput() {
  const output = document.getElementById("output");
  navigator.clipboard.writeText(output.textContent).then(() => {
    alert("Recap copied to clipboard!");
  });
}
</script>
</body>
</html>
